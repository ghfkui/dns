{
    "type": "Ext.panel.Panel",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "container|align": "stretch",
        "designer|userAlias": "RoutemgrView",
        "designer|userClassName": "RoutemgrView",
        "layout": "vbox",
        "rowUpdate": false,
        "title": "路由管理",
        "urlUpdate": "../route/update"
    },
    "name": "RoutemgrView1",
    "configAlternates": {
        "rowUpdate": "boolean"
    },
    "designerId": "19bb6a81-cd77-4d0a-9510-d560245c591a",
    "customConfigs": [
        {
            "group": "(Custom Properties)",
            "name": "rowUpdate",
            "type": "string"
        },
        {
            "group": "(Custom Properties)",
            "name": "urlUpdate",
            "type": "string"
        }
    ],
    "viewControllerInstanceId": "bc4ed661-297c-4f4c-a714-2817e5a02463",
    "viewModelInstanceId": "7ed8e7f9-1497-4ebc-8586-1867e5c0d700",
    "cn": [
        {
            "type": "Ext.tab.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "activeTab": 0,
                "layout|flex": 1,
                "margin": 10
            },
            "name": "MyTabPanel3",
            "designerId": "93bf216d-9486-4ce6-87b4-dcd386d0c9f8",
            "cn": [
                {
                    "type": "Ext.panel.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "autoScroll": true,
                        "container|align": "stretch",
                        "layout": "vbox",
                        "title": "路由列表"
                    },
                    "name": "MyPanel17",
                    "designerId": "34fef46e-5105-42b6-8ea6-5d7117493cdc",
                    "cn": [
                        {
                            "type": "Ext.tab.Tab",
                            "reference": {
                                "name": "tabConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "TabConfig8",
                            "designerId": "a643af52-8705-4e33-aa6a-3ced78b6bb9e"
                        },
                        {
                            "type": "Ext.grid.Panel",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "autoLoad": true,
                                "autoScroll": true,
                                "header": false,
                                "itemId": "routeList",
                                "layout|flex": 1,
                                "scroll": "vertical",
                                "store": "StoreRoute",
                                "title": "routeList"
                            },
                            "name": "MyGridPanel",
                            "designerId": "dfcb9644-5079-4fbb-b2c8-fb3f798ffaac",
                            "cn": [
                                {
                                    "type": "Ext.grid.column.Column",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dataIndex": "route",
                                        "text": "名称",
                                        "width": "10%"
                                    },
                                    "name": "MyColumn3",
                                    "designerId": "fb585664-bd38-4e10-9ae1-ebfc1f80709c"
                                },
                                {
                                    "type": "Ext.grid.column.Column",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dataIndex": "eth",
                                        "text": "网卡"
                                    },
                                    "name": "MyColumn",
                                    "designerId": "e87cc632-ccbf-42fe-9888-ac9beabdf916"
                                },
                                {
                                    "type": "Ext.grid.column.Column",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dataIndex": "address",
                                        "text": "网络地址",
                                        "width": "20%"
                                    },
                                    "name": "MyColumn5",
                                    "designerId": "582d7aa7-5274-4239-84bb-5f010082484d"
                                },
                                {
                                    "type": "Ext.grid.column.Column",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dataIndex": "gateway",
                                        "text": "网关地址",
                                        "width": "20%"
                                    },
                                    "name": "MyColumn4",
                                    "designerId": "e023c65f-c4b5-4231-b546-88c0edbf0300"
                                },
                                {
                                    "type": "Ext.grid.column.Column",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dataIndex": "enabled",
                                        "text": "状态"
                                    },
                                    "name": "MyColumn7",
                                    "designerId": "fd57bde4-5f5f-41a7-8d82-9eb4398654c1",
                                    "cn": [
                                        {
                                            "type": "fixedfunction",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "designer|params": [
                                                    "value",
                                                    "metaData",
                                                    "record",
                                                    "rowIndex",
                                                    "colIndex",
                                                    "store",
                                                    "view"
                                                ],
                                                "fn": "renderer",
                                                "implHandler": [
                                                    "if(record.data.enabled == 1){",
                                                    "    return '<a href=\"#\" class=\"enable\">启用</a>';",
                                                    "}else{",
                                                    "    return '<a href=\"#\" class=\"disable\">停用</a>';",
                                                    "}"
                                                ]
                                            },
                                            "name": "renderer",
                                            "designerId": "45d88fb5-9334-4c53-95d2-337cc8efa859"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.grid.column.Column",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dataIndex": "memo",
                                        "text": "备注"
                                    },
                                    "name": "MyColumn8",
                                    "designerId": "160707b2-3ceb-4543-90fe-6a913b5d6149"
                                },
                                {
                                    "type": "Ext.grid.View",
                                    "reference": {
                                        "name": "viewConfig",
                                        "type": "object"
                                    },
                                    "codeClass": null,
                                    "name": "MyGridView",
                                    "designerId": "cf2f1eaa-1c49-4c37-81ed-2382332d1cbc"
                                },
                                {
                                    "type": "Ext.grid.column.Action",
                                    "reference": {
                                        "name": "columns",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "text": "操作"
                                    },
                                    "name": "MyActionColumn",
                                    "designerId": "543d2465-7bd5-4ed4-9697-c3a7e0a9d3a0",
                                    "cn": [
                                        {
                                            "type": "actioncolumnitem",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "altText": "修改",
                                                "designer|displayName": "edit",
                                                "icon": "image/edit.gif",
                                                "tooltip": "修改"
                                            },
                                            "name": "MyActionColumnItem",
                                            "designerId": "b0bb8187-c7d4-4a37-9341-c619dede5489",
                                            "cn": [
                                                {
                                                    "type": "fixedfunction",
                                                    "reference": {
                                                        "name": "items",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "designer|params": [
                                                            "view",
                                                            "rowIndex",
                                                            "colIndex",
                                                            "item",
                                                            "e",
                                                            "record",
                                                            "row"
                                                        ],
                                                        "fn": "handler",
                                                        "implHandler": [
                                                            "console.log('a');",
                                                            "var tabpanel = view.up('tabpanel'),",
                                                            "    routeAddForm = tabpanel.down(\"form#routeAddForm\"),",
                                                            "    panel = tabpanel.up(\"panel\");",
                                                            "panel.rowUpdate = true;",
                                                            "routeAddForm.getForm().setValues(record.data);",
                                                            "routeAddForm.down(\"textfield[name=route]\").setDisabled(true);",
                                                            "tabpanel.setActiveItem(1);"
                                                        ]
                                                    },
                                                    "name": "handler",
                                                    "designerId": "64ba93a3-bf7d-442d-8023-db7526f917b5"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "actioncolumnitem",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "altText": "删除",
                                                "designer|displayName": "delete",
                                                "icon": "image/delete.gif",
                                                "tooltip": "删除"
                                            },
                                            "name": "MyActionColumnItem3",
                                            "designerId": "9dfbdca0-e82f-4f3b-8a95-b5b42c7fcd72",
                                            "cn": [
                                                {
                                                    "type": "fixedfunction",
                                                    "reference": {
                                                        "name": "items",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "designer|params": [
                                                            "view",
                                                            "rowIndex",
                                                            "colIndex",
                                                            "item",
                                                            "e",
                                                            "record",
                                                            "row"
                                                        ],
                                                        "fn": "handler",
                                                        "implHandler": [
                                                            "var route = record.data;",
                                                            "var confirm = {",
                                                            "    title: \"确认删除\",",
                                                            "    msg: \"请确认是否删除这个路由\",",
                                                            "    closable: false,",
                                                            "    buttons: Ext.MessageBox.YESNO,",
                                                            "    icon: Ext.MessageBox.WARNING,",
                                                            "    fn: function(btn) {",
                                                            "        if (btn == \"yes\") {",
                                                            "            Ext.Ajax.request({",
                                                            "                url: '../route/remove',",
                                                            "                success: function(data, a1, a2) {",
                                                            "                    view.getStore().load();",
                                                            "                    var result = Ext.decode(data.responseText);",
                                                            "                    if (result.success) {",
                                                            "                        Ext.Msg.alert('成功', result.msg);",
                                                            "                    }",
                                                            "                },",
                                                            "                failure: function(data) {",
                                                            "                    Ext.Msg.alert('失败', \"删除失败\");",
                                                            "                },",
                                                            "                jsonData: {",
                                                            "                    id: this.route.id",
                                                            "                },",
                                                            "                scope: {",
                                                            "                    route: this.route,",
                                                            "                    view: this.view",
                                                            "                }",
                                                            "            });",
                                                            "        }",
                                                            "    },",
                                                            "    scope: {",
                                                            "        route: route,",
                                                            "        view: view",
                                                            "    }",
                                                            "};",
                                                            "Ext.MessageBox.show(confirm, this);"
                                                        ]
                                                    },
                                                    "name": "handler",
                                                    "designerId": "c4d5a7f8-0856-4a2d-b562-ee8c957a4661"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "type": "linkedinstance",
                                    "reference": {
                                        "name": "dockedItems",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "dock": "bottom",
                                        "store": "StoreRoute"
                                    },
                                    "name": "pagingtoolbar5",
                                    "designerId": "cdf61c37-f43b-4896-b89b-757152f1ecd6",
                                    "masterInstanceId": "40325ae5-e6ff-42f0-9102-2dbf216cd896"
                                },
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onRouteListCellClick",
                                        "implHandler": [
                                            "var target = e.target,",
                                            "    route = record.data,",
                                            "    enabled = 0;",
                                            "if(target && target.className.indexOf(\"disable\") != -1){",
                                            "    enabled = 1;",
                                            "}",
                                            "Ext.Ajax.request({",
                                            "    url: '../route/status',",
                                            "    success: function(data, a1, a2) {",
                                            "",
                                            "        var result = Ext.decode(data.responseText);",
                                            "        if (result.success) {",
                                            "            this.route.enabled = this.enabled;",
                                            "            this.view.refresh();",
                                            "        }",
                                            "    },",
                                            "    failure: function(data) {",
                                            "        Ext.Msg.alert('失败', \"操作失败\");",
                                            "    },",
                                            "    jsonData: {",
                                            "        id: route.id,",
                                            "        enabled: enabled",
                                            "    },",
                                            "    scope: {",
                                            "        route: route,",
                                            "        enabled: enabled,",
                                            "        view: tableview",
                                            "    }",
                                            "});"
                                        ],
                                        "name": "cellclick",
                                        "scope": "me"
                                    },
                                    "name": "onRouteListCellClick",
                                    "designerId": "52eff2e1-b418-4a5a-a47c-1e25b9416f40"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "Ext.panel.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "rowUpdate": null,
                        "title": "添加路由"
                    },
                    "name": "MyPanel20",
                    "designerId": "50de1259-3129-4611-a357-d7e730a57189",
                    "customConfigs": [
                        {
                            "group": "(Custom Properties)",
                            "name": "rowUpdate",
                            "type": "string"
                        }
                    ],
                    "cn": [
                        {
                            "type": "Ext.tab.Tab",
                            "reference": {
                                "name": "tabConfig",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "TabConfig12",
                            "designerId": "66bc7b99-085c-42d9-8be8-0ecfaf7607ef"
                        },
                        {
                            "type": "Ext.form.Panel",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "bodyPadding": 10,
                                "header": false,
                                "itemId": "routeAddForm",
                                "jsonSubmit": true,
                                "title": null,
                                "url": "../route/add"
                            },
                            "name": "MyForm8",
                            "designerId": "d3e74e76-0283-46a4-acde-932a78ba1c95",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Number",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": null,
                                        "fieldLabel": "id",
                                        "hidden": true,
                                        "layout|anchor": "60%",
                                        "name": "id"
                                    },
                                    "name": "MyNumberField8",
                                    "designerId": "a13410af-7f87-4a96-9d49-95ffd58a6e2c"
                                },
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false,
                                        "fieldLabel": "路由名称",
                                        "layout|anchor": "60%",
                                        "name": "route"
                                    },
                                    "name": "MyTextField12",
                                    "designerId": "97c57018-1c26-4103-a73b-9f366d86c8c7"
                                },
                                {
                                    "type": "Ext.form.field.ComboBox",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "disableKeyFilter": true,
                                        "displayField": "name",
                                        "fieldLabel": "选择网卡",
                                        "layout|anchor": "60%",
                                        "name": "eth",
                                        "store": "StoreEth",
                                        "valueField": "name",
                                        "width": null
                                    },
                                    "name": "MyComboBox2",
                                    "designerId": "5a7046e0-bf44-453f-b011-00eccdafd6df"
                                },
                                {
                                    "type": "Ext.form.FieldContainer",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fieldLabel": "Label",
                                        "height": 30,
                                        "hideLabel": true,
                                        "layout": "hbox"
                                    },
                                    "name": "MyFieldContainer5",
                                    "designerId": "2a2e4831-acce-4c28-8a00-d7969fcf24df",
                                    "cn": [
                                        {
                                            "type": "Ext.form.field.Text",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "fieldLabel": "网络地址",
                                                "layout|flex": null,
                                                "name": "ip"
                                            },
                                            "name": "MyTextField11",
                                            "designerId": "b0eb8797-799e-4ce3-ac06-4ec1010e397f"
                                        },
                                        {
                                            "type": "Ext.form.field.ComboBox",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "disableKeyFilter": true,
                                                "displayField": "mask",
                                                "fieldLabel": " /",
                                                "labelPad": null,
                                                "labelSeparator": "/",
                                                "labelWidth": 5,
                                                "margin": "0 0 0 5",
                                                "name": "mask",
                                                "padding": null,
                                                "store": "StoreMask",
                                                "valueField": "mask",
                                                "width": 60
                                            },
                                            "name": "MyComboBox3",
                                            "designerId": "bece4c12-289b-48bd-8419-89e978d6d9d0"
                                        }
                                    ]
                                },
                                {
                                    "type": "Ext.form.field.Text",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "allowBlank": false,
                                        "fieldLabel": "网关",
                                        "layout|anchor": "60%",
                                        "modelValidation": false,
                                        "name": "gateway"
                                    },
                                    "name": "MyTextField",
                                    "designerId": "462d363a-3147-4c3a-9666-c7799e8350e8"
                                },
                                {
                                    "type": "Ext.form.field.TextArea",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fieldLabel": "描述",
                                        "layout|anchor": "60%",
                                        "name": "memo"
                                    },
                                    "name": "MyTextArea4",
                                    "designerId": "a07170e6-d685-4b5d-ac78-229fb4d26acf"
                                },
                                {
                                    "type": "Ext.form.field.Checkbox",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "boxLabel": "立即启用",
                                        "fieldLabel": "生效设置",
                                        "layout|anchor": "100%",
                                        "name": "enabled"
                                    },
                                    "name": "MyCheckbox2",
                                    "designerId": "866dcee9-1186-457f-9b12-2e5b98dd76a2"
                                },
                                {
                                    "type": "Ext.toolbar.Toolbar",
                                    "reference": {
                                        "name": "dockedItems",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "container|align": "bottom",
                                        "container|padding": null,
                                        "dock": "bottom"
                                    },
                                    "name": "MyToolbar3",
                                    "designerId": "9eaa2ae5-606e-48ad-9ed5-1d38c4997b19",
                                    "cn": [
                                        {
                                            "type": "Ext.button.Button",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "itemId": "save",
                                                "layout|flex": null,
                                                "text": "保存"
                                            },
                                            "name": "MyButton10",
                                            "designerId": "be016948-99f7-44b3-833c-908673b2b94f",
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onSaveClick",
                                                        "implHandler": [
                                                            " var me = this,",
                                                            "     form = me.down('form#routeAddForm'),",
                                                            "     valid = form.isValid();",
                                                            "if(!valid){",
                                                            "    return false;",
                                                            "}",
                                                            "if(me.rowUpdate){",
                                                            "    form.getForm().url = me.urlUpdate;",
                                                            "}",
                                                            "form.submit({",
                                                            "    waitMsg: '正在保存',",
                                                            "    success: function (form, action) {",
                                                            "        Ext.Msg.alert('成功', '路由保存成功');",
                                                            "        ",
                                                            "        if(me.rowUpdate){",
                                                            "            me.down(\"pagingtoolbar\").doRefresh();",
                                                            "        }else{",
                                                            "            me.down(\"gridpanel#routeList\").getStore().load();",
                                                            "        }",
                                                            "        me.resetForm();",
                                                            "",
                                                            "    },",
                                                            "    failure: function (form, action) {",
                                                            "        Ext.Msg.alert('失败',  action.result.msg);",
                                                            "    }",
                                                            "});"
                                                        ],
                                                        "name": "click",
                                                        "scope": "me"
                                                    },
                                                    "name": "onSaveClick",
                                                    "designerId": "d14ee20e-0b99-415d-a382-84495a87348e"
                                                }
                                            ]
                                        },
                                        {
                                            "type": "Ext.button.Button",
                                            "reference": {
                                                "name": "items",
                                                "type": "array"
                                            },
                                            "codeClass": null,
                                            "userConfig": {
                                                "itemId": "cancel",
                                                "layout|flex": null,
                                                "margin": "0 0 0 50",
                                                "text": "取消",
                                                "textAlign": null
                                            },
                                            "name": "MyButton12",
                                            "designerId": "439816ac-bbf4-4323-854c-95e1ea43c123",
                                            "cn": [
                                                {
                                                    "type": "basiceventbinding",
                                                    "reference": {
                                                        "name": "listeners",
                                                        "type": "array"
                                                    },
                                                    "codeClass": null,
                                                    "userConfig": {
                                                        "fn": "onCancelClick",
                                                        "implHandler": [
                                                            "this.resetForm();"
                                                        ],
                                                        "name": "click",
                                                        "scope": "me"
                                                    },
                                                    "name": "onCancelClick",
                                                    "designerId": "efa829ac-4919-4403-9060-2970d9e60f6e"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "type": "basiceventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onPanelDeactivate",
                                "implHandler": [
                                    "this.resetForm();"
                                ],
                                "name": "deactivate",
                                "scope": "me"
                            },
                            "name": "onPanelDeactivate",
                            "designerId": "4da09f9a-d9b3-438d-8a70-693622fcc86d"
                        }
                    ]
                }
            ]
        },
        {
            "type": "basicfunction",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "fn": "resetForm",
                "implHandler": [
                    "var me = this,",
                    "    tabpanel = me.down(\"tabpanel\"),",
                    "    routeAddForm = me.down(\"form#routeAddForm\");",
                    "tabpanel.setActiveItem(0);",
                    "routeAddForm.down(\"textfield[name=route]\").setDisabled(false);",
                    "routeAddForm.reset();"
                ]
            },
            "name": "resetForm",
            "designerId": "97c65225-b5f1-491a-8a20-7771031a4cee"
        }
    ]
}